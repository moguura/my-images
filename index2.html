<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF音声認識問題</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #pdfViewer { width: 100%; height: 600px; }
        button { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>音声認識問題</h1>
    <p>以下のPDFのページを一つずつ表示します。</p>

    <!-- PDF表示 -->
    <iframe id="pdfViewer" src="" style="display:none;"></iframe>

    <!-- ページ切り替えボタン -->
    <button id="prevButton" style="display:none;">前のページ</button>
    <button id="nextButton">次のページ</button>

    <!-- 音声認識ボタン -->
    <button id="startButton" style="display:none;">音声を話す</button>
    <div id="result"></div>

    <script>
        const pdfPages = [
            "https://raw.githubusercontent.com/moguura/my-images/main/%E3%83%97%E3%83%AC%E3%82%BC%E3%83%B3%E3%83%86%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B31.pdf#page=1",
            "https://raw.githubusercontent.com/moguura/my-images/main/%E3%83%97%E3%83%AC%E3%82%BC%E3%83%B3%E3%83%86%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B31.pdf#page=2",
            "https://raw.githubusercontent.com/moguura/my-images/main/%E3%83%97%E3%83%AC%E3%82%BC%E3%83%B3%E3%83%86%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B31.pdf#page=3",
            "https://raw.githubusercontent.com/moguura/my-images/main/%E3%83%97%E3%83%AC%E3%82%BC%E3%83%B3%E3%83%86%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B31.pdf#page=4",
            "https://raw.githubusercontent.com/moguura/my-images/main/%E3%82%AF%E3%82%A4%E3%82%BA%E6%AD%A3%E8%A7%A32.mp3"
        ];

        let currentPage = 0;

        function loadPage() {
            const pdfViewer = document.getElementById('pdfViewer');
            pdfViewer.src = pdfPages[currentPage];
            pdfViewer.style.display = 'block';
            document.getElementById('result').textContent = '';
            document.getElementById('startButton').style.display = 'block';

            // ボタンの表示制御
            document.getElementById('prevButton').style.display = currentPage > 0 ? 'inline' : 'none';
            document.getElementById('nextButton').style.display = currentPage < pdfPages.length - 1 ? 'inline' : 'none';
        }

        document.getElementById('prevButton').addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage--;
                loadPage();
            }
        });

        document.getElementById('nextButton').addEventListener('click', () => {
            if (currentPage < pdfPages.length - 1) {
                currentPage++;
                loadPage();
                // 最後のページの場合、音声再生ボタンを表示
                if (currentPage === pdfPages.length - 1) {
                    playAudio();
                }
            }
        });

        document.getElementById('startButton').addEventListener('click', () => {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'ja-JP';
            recognition.start();

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('result').textContent = `あなたの発言: ${transcript}`;
                
                // 「いいです」と言った場合
                if (transcript === 'いいです' && currentPage === 4) {
                    alert("正解です！");
                } else {
                    alert("もう一度試してください。");
                }
            };

            recognition.onerror = () => {
                document.getElementById('result').textContent = 'エラーが発生しました。';
            };
        });

        function playAudio() {
            const audio = new Audio(pdfPages[pdfPages.length - 1]);
            audio.play();
        }

        // 初期ページ読み込み
        loadPage();
    </script>
</body>
</html>
